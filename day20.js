const input = `Tile 2297:
###.###..#
.....#.#.#
......##.#
..........
##....#...
#.#...##.#
##...#..##
#...#.####
#.##.###..
####..#.##

Tile 2459:
..#.#.#..#
..###...#.
#....#.#.#
...#.#.#..
#..#.....#
###.#...##
.#....#...
##....#...
...#......
##....#.##

Tile 3547:
.#..##.##.
....####..
#....#..#.
#......#.#
...####.##
...#.#....
...##..#.#
###.###...
#....#...#
##.###...#

Tile 1741:
###.###...
#.#.#....#
#..#...###
###...##.#
.....#..#.
#........#
...#.....#
.........#
....#.#..#
#####.#.##

Tile 2237:
#....#..##
...#.....#
##.......#
.#........
......#..#
##..######
....#...##
#...#.#..#
...#......
.#.##..##.

Tile 1889:
#..###.###
#.####...#
....##.#.#
...#.#...#
..........
#...#.##.#
#..#.##.##
#...#.....
###.#..#.#
.#..#..##.

Tile 3061:
##.####...
#.##...#..
#.....##..
#.....#..#
#.....#.#.
#.#......#
.#.##....#
.#.......#
#.#.#...#.
#...#...##

Tile 1907:
#...#.###.
...#..#..#
##.###...#
#....#...#
##...#..##
.###......
.#..#..##.
#....##..#
.#....##..
.#...#####

Tile 1193:
#..##..##.
...#.....#
......#...
.#......#.
.#.##...##
..#..#...#
#.#.....##
...#.#....
#..##.....
####..##..

Tile 3733:
###.##...#
#......#..
##....#...
##..###...
##.##.###.
#........#
#....#...#
.....###..
.#......##
....##..##

Tile 1327:
#####.##.#
..#.....##
.#...#..#.
#..#..##.#
..#.......
......#...
#...#..###
##........
......#...
.###.#.###

Tile 3907:
..#..##.##
#......##.
...##....#
.........#
.###..#...
#.#.#.....
#..#.....#
.#..##.#.#
....#....#
.#.#..#.##

Tile 3019:
###......#
#...#..#.#
#..#.#....
#..#.....#
.....###..
.........#
..#.......
##.#.....#
#.....#.#.
...##...##

Tile 1277:
..####.##.
..........
...#...#.#
......#...
#..#.#...#
.#...#...#
##....#.##
..#.....##
#.......#.
#.....##..

Tile 2659:
##...#...#
..#....###
.#.#..#..#
....#.##..
.....#...#
#.#.......
..........
....##..##
..........
.#..####.#

Tile 3673:
..###..#..
..#.......
..........
##....#.#.
....#..#..
...#......
#..#...#.#
......#...
..##.#...#
#.##......

Tile 3329:
#....#..#.
#....#...#
##.#.....#
.......#.#
#..##.#.#.
#...##....
##.#.##...
#........#
.#...##.#.
.####...#.

Tile 2383:
#...####.#
##......##
.......###
#.........
..#..#..##
.#.####.#.
.#..##...#
#.#..#....
..#.#..#.#
......####

Tile 2377:
...#....#.
....#..#.#
.#.......#
#....##...
..#.####..
#.......#.
.......#..
....#...##
.......#..
##..#..#..

Tile 1931:
###.#...##
...##...##
.#.#..#.#.
#...#.##.#
.........#
##........
...#..#...
......#.#.
#...#...##
##..#..#..

Tile 3911:
#..####...
...##..#..
##.....#..
###.....##
..........
...#..##.#
#......###
#.#....#.#
#..#.###.#
.....#####

Tile 3251:
##.##.#.#.
#....#.#..
#....#...#
#.#...#.#.
#.......##
..#....#..
..##...#..
.#.#..#..#
..#.#..#.#
#..#......

Tile 1879:
##.#.#.###
...#...#.#
.#.#.#....
#..#.##..#
#.......##
#........#
..##......
.#.....#.#
...#....##
.###.#.###

Tile 2819:
#.#....###
..#....##.
#.#.......
..#.#..#.#
.#.#......
#...#.....
.#...#....
.#..#.##..
.###..#.##
...##.#.##

Tile 2351:
..#..##.#.
#.#....#..
#.##...##.
........##
#....#....
...#....#.
#.#.##....
.##.#.##.#
.##.......
###..#..##

Tile 2801:
#.#....#..
#......##.
.#..#..#..
....#...##
....##.#..
##........
#.##.#.#..
.##...#...
..........
###..##.#.

Tile 1873:
#.#.....##
#........#
#........#
.#........
........#.
......#.#.
...#......
....#.....
#.#.......
#.#...#..#

Tile 2437:
###.##..#.
#.##..##..
..#.#...##
#.....##.#
##.......#
....#..#..
#..##...#.
..#.##....
......##..
..##..#...

Tile 2579:
#..##.####
##.#...#.#
.##..#...#
##.....#..
###.......
#....#....
#..#.#...#
#...#...##
.#.#....##
#.#..#....

Tile 1609:
.#..##.##.
#..##....#
#....#..##
#....#.###
#.####....
##..##.#..
..#.#...#.
...##....#
#...##...#
##..#..###

Tile 3929:
..###...##
##........
##.##....#
..#..#.#..
..#.#....#
#.##..#...
.##......#
##.#.....#
#.......##
..##.##...

Tile 1487:
..####.#..
#.#.#...#.
.........#
#...#.....
#......#..
#......#.#
###......#
#..#.###..
.......#.#
#..##..###

Tile 1811:
..#....##.
..#.#...#.
.......#..
...#.#...#
#..##...#.
..........
#...#...##
....#....#
#.#...#...
.#.#..###.

Tile 1747:
#..##.#.#.
#..#......
..#.###..#
..#.#.....
#.##.....#
#........#
##...###..
...#...#..
..#.#..#.#
#..##.###.

Tile 3779:
#.#####...
...#.....#
..#.#....#
.#.#......
##.....##.
##.....###
#.##.#.###
.#.#.###.#
....#.....
......#...

Tile 3767:
.##.##.###
#.#.....#.
#...#..##.
###....##.
.....##...
..#.......
......#..#
....#..#..
#......#..
##..#.#...

Tile 1871:
.#.###...#
##...###..
#..#...###
......#..#
#....####.
#.#......#
..........
##......#.
..........
##..#.##.#

Tile 3803:
##..#.#..#
#........#
#.........
....#...#.
#.#...##.#
#..##.....
###...#...
#.##.#.#.#
...#####.#
#..#.#....

Tile 2441:
.##..#.#.#
.........#
#..#..#.##
#...#...##
.....#..#.
...#.#...#
#........#
..##.#.#.#
#....#...#
.#..#..###

Tile 3373:
..###.....
...##....#
#...##....
.#........
#.......#.
..#.......
...#.#...#
#.....##..
..........
#####.#...

Tile 1721:
###.....##
#.........
...#......
#.....#...
..#......#
#........#
#..#....#.
#.......#.
.#....#...
#.##....#.

Tile 3499:
####...#.#
...##....#
#...#..#..
...#......
#.....##..
.........#
.#.......#
.#..#...##
#..#...##.
.#######..

Tile 3851:
#.##.#....
#..#....##
.#.##....#
.........#
#..#.#..#.
.....#...#
#.#.#....#
#.....#..#
####.....#
######.#.#

Tile 1181:
...#..####
....#....#
#.......##
##........
.##....#.#
..#......#
#.....#..#
.....#..#.
#..####..#
..#####.##

Tile 2269:
##.#...###
..##.#.#.#
##......##
.....#...#
.#.......#
#.#..##..#
##........
.#........
##.....#..
.##......#

Tile 2903:
.#.#.###..
.#..#.#..#
........#.
..#....#..
#.....#...
......###.
#.#....#..
#.#.#.#...
#........#
###.##...#

Tile 2927:
.##..####.
#.......#.
#........#
#.....##.#
##........
..#.......
#.......##
.##..#.#..
.......#..
...#..#..#

Tile 2083:
#.##.#..##
...#...##.
.......##.
...#..#...
###..#...#
##.......#
###.#.....
...#......
.#..#....#
...###..##

Tile 1621:
#.###.###.
..........
......##..
#.#....#.#
.#.#.###.#
#.........
#......#.#
#.#.##....
#...##...#
.#####....

Tile 2797:
........##
#..#.....#
..........
###.....##
#........#
#.........
#....####.
...#.###.#
......#.##
#...#.#.#.

Tile 1433:
.##..#....
#.....#.#.
.#.......#
..#..#.#.#
....#.....
#.#.......
..#.#..##.
#....#.#..
.........#
..#.##..##

Tile 1259:
.###...#..
#..#..#.##
#..#.#....
##..##.###
#.#...#.##
.......#.#
#.#....#.#
.##..##..#
.##..#....
.######.#.

Tile 1657:
#..##..##.
..###....#
###.......
.##.#....#
#.......##
##.#......
..........
#.#.....##
..#..#....
.#.#..#.##

Tile 3323:
..##.#####
....##..#.
#.#......#
#....#..##
#..#.....#
##........
.###.##...
.#.....###
...#..#..#
.##..###..

Tile 2203:
##....##.#
#.#.#..#.#
...#.##...
#....#.#.#
#.........
.##..#...#
#.....#.#.
.##.#..#.#
.#...#...#
...###....

Tile 2477:
#######...
..#....#..
#.........
#.#.....##
#...##....
...#.....#
#......#..
......#...
####.#..##
.#....####

Tile 3343:
#.#####.#.
....#..#..
........##
..#.##....
.#..#....#
.....#....
#.#.#....#
...#....##
#.##.#...#
.#..##..##

Tile 3821:
#.##..#..#
.........#
.#........
........#.
..#.......
#.##......
#......#..
....###.#.
#..#......
#.#.#.....

Tile 3347:
####....#.
#.........
#...#.....
.#..#.....
.#.......#
....#..#.#
.#.#.....#
...#......
.....##..#
.#######..

Tile 3877:
.#.#.####.
.......#.#
#.......#.
#..#.#.#.#
..#.#.#...
##.......#
....#...#.
..##..#..#
##.##..#..
#..#...#.#

Tile 3739:
.##.###.#.
#.##.....#
#.........
....#....#
#....#....
.#.#......
.#......#.
...#......
.........#
##.#.##.#.

Tile 3257:
..##.###..
.....##.##
#..###..##
.......#..
....#.....
..##......
#.#......#
#....#....
#...##....
#..####.#.

Tile 2969:
#.#.......
..#......#
...#.....#
.#.......#
#..#......
#..#.....#
#.#....##.
..#.....##
#..#.#..#.
...##.#..#

Tile 1097:
#####...#.
#..####..#
.##.#.##.#
#.......##
##.......#
#...#..#.#
#.......##
.......#..
......#...
..#.#.##.#

Tile 2011:
#.##.....#
#....#..##
.....#....
..##.#...#
#...#.....
...##.##..
###.##..##
#.#.##...#
#....#...#
#.##..#.##

Tile 1399:
#####..#.#
.###.#...#
#......#.#
...#.#....
##..#.#.#.
......#.##
......#..#
#..#.#....
#.#...#..#
##..####.#

Tile 3449:
.###..#...
.###..#.#.
..........
#.......##
...#..####
##.......#
.....#.#.#
#.#..#.#.#
.#...#..#.
#.##.#...#

Tile 2897:
#.#.......
..##......
#..#....##
.#........
#.#...#...
...#....##
#.##..#...
..#.#.....
.#.#......
.##..#..##

Tile 1153:
....#.#...
#.##.##..#
..#.##.#.#
.#...#.#..
..#...#...
......#.##
.#.......#
#.....#.#.
.#...#...#
.....#...#

Tile 2789:
#...####.#
##.#.....#
.......#..
......#..#
......#..#
..#.....##
....##..##
#...#.#..#
##...#.#..
..##.#....

Tile 1637:
.....#.#..
..#..#...#
#.....#.##
.#..#.....
#..#.....#
..#.#.##.#
.......#.#
....#.....
##.#.....#
##..#...#.

Tile 2029:
.#.#...#..
#...##...#
#.....##.#
##...#.##.
#.#..#....
#.....#...
#.........
..........
.#.###.#..
.#...####.

Tile 2239:
.####..#..
...#...#.#
##..#....#
..........
..#......#
.#........
##........
..........
..........
#..#####.#

Tile 2663:
.#...#...#
....#.#...
#....#...#
..##..###.
#....##...
##........
.#...#..##
.........#
.#...##.#.
..#...#...

Tile 1567:
..###.##..
#...#..#..
#.#......#
#......#..
#.#..#..##
.#..#.#..#
#.......#.
#.#.#...#.
....#....#
..#.....##

Tile 2467:
.#########
#..#......
#.#.....#.
.....#..#.
#...#....#
###.......
##...#.#.#
...#.#..##
#.....##.#
#..##.#..#

Tile 1447:
.#####..#.
...#..#...
.#..#..#..
...#.#.#.#
.#........
..#.......
#.......#.
#.##..#...
.........#
#####.##.#

Tile 3863:
.#...##..#
.#..#..#..
.........#
#......#.#
#...##....
.#........
#..##..#..
....#..##.
#.......##
.##...##..

Tile 3761:
..#....###
#.........
.#....#.##
##.......#
.........#
#.........
...#...#..
#......#..
......##..
#...##....

Tile 2027:
.##.#.##..
#.....#.##
....#....#
....#.#...
#.....#.#.
....#.#...
####......
.....##...
......#..#
....#...##

Tile 1279:
..#.#####.
#.#....#..
#.......#.
#.....#...
.#........
......##.#
#......#..
#.......##
.#...#....
.####..#..

Tile 1997:
#.#.#...#.
......#..#
###.......
#.......#.
#..#......
..#...#..#
...##.....
...#......
..........
..##...##.

Tile 3049:
..##.##...
.......#..
#...#....#
#..#.#....
.#..#.#.#.
.#.##...##
......#...
#..#....#.
..........
##...#.###

Tile 3209:
##..###.##
.....#..#.
#.#.#...##
#.#...#.##
....#...#.
..#.......
#....#..##
###...#...
#......#.#
##.#...###

Tile 3719:
####.##..#
.........#
..#.......
#.#.......
.##....##.
#.....#..#
.#.#..##.#
#.#.#.....
##..#.#.#.
..#...##..

Tile 3217:
..##.####.
...#.....#
.#.......#
.......#..
#...#.#...
..#.#..#..
.##......#
#.........
....#...##
..##..##.#

Tile 1913:
######.#.#
##....#.#.
.........#
#.#.#.....
#..##.#..#
#.....##.#
........##
........#.
#.....#...
###..##..#

Tile 2729:
.###.#..#.
..#..#...#
#..#.#.#..
.#...#...#
#......#..
...#..##.#
..........
.#........
#.#...##.#
##.####.#.

Tile 3089:
#...#.#.#.
..###.##..
#.#...##..
#......##.
..#...###.
#........#
.###..##.#
#..#......
#...#..#.#
#..#####..

Tile 3923:
.......##.
##.......#
#...#.#.#.
.......#..
.#.......#
#......##.
#.#...#..#
.....#..#.
#.....#...
.#..##.###

Tile 3229:
##..####.#
.....#..#.
#.#..#..#.
..........
.....#....
.........#
#.#.#.##.#
#.#.......
.#.#...###
##..#.#.#.

Tile 1571:
###....##.
.#.#..###.
##....####
..#.#..#..
.....#....
.#....#..#
....#.##.#
#..#.###.#
..#.....#.
.##..###.#

Tile 1063:
####.#####
.#....#...
#......#.#
........##
..##...#.#
##....#..#
#...##.#..
###.......
#....#...#
####.####.

Tile 1663:
..###.####
.....##..#
..#...##..
#..#..#...
#.#.......
...##.....
#....#.#.#
#.#..##...
.......#..
#.###.##..

Tile 1987:
..#...#...
....#...##
.#...#...#
..........
.#....#.##
####....#.
......#...
........##
#.....##.#
....###.#.

Tile 2803:
.##.#.##.#
#.#.....#.
#..#....#.
....#.#..#
...#..#...
#.#..##..#
.#.##..##.
..#...#.#.
#.##.#....
.#.###..##

Tile 1699:
.#.##.##.#
#.#.......
##.##.....
......##..
.#....#..#
..........
.........#
#...#.....
...###.##.
#....#####

Tile 1999:
..#..##..#
#..###...#
....##...#
.#....#...
.........#
#...#.....
.........#
#....#..##
..........
..#...####

Tile 1733:
#....#..##
##..#....#
#....#...#
###.......
#..#...#.#
.....#...#
.#.......#
.#....#..#
..#.#.#.##
......####

Tile 2273:
#...#..###
.#.##.#..#
###..##..#
##....#...
.....#..#.
...#..#...
#..#.#...#
#.........
..##...#..
.###.#.#..

Tile 1493:
##.#...##.
#...#...##
..#......#
##..#.....
##........
....#.....
#......###
......#...
##.....#..
#.#.#.....

Tile 3637:
..##.#.#..
#..###...#
....#..##.
##......#.
##.#.#...#
..#...#..#
#...#.....
..#..##...
.....#..##
.#.##...##

Tile 2333:
##.#...#..
#......###
..#.....##
.##......#
...##.##..
#..#.#.#..
....#.##.#
...#...#.#
.###....#.
.#.#.##..#

Tile 1201:
..#.#.####
..#...##..
#..##....#
#.#...#...
.....#....
...#....#.
....#....#
...#......
.##..##.##
###.#..##.

Tile 2243:
#..######.
.........#
...#....##
#...#..#..
#..#....#.
.....##...
.....#.#..
#........#
.#....#.##
####.#.#.#

Tile 1667:
##...##..#
....##...#
##..#..###
.....#..##
#........#
..#......#
#....#..##
#.........
##....##..
#..###...#

Tile 2053:
#.##.####.
#..##..##.
......#.##
.....#...#
#.##...#..
###.##..##
###.#..#..
#..#...#.#
#.#.#..###
#.#..####.

Tile 3407:
.##......#
#........#
......#..#
...#.#..##
#....##...
#....#..##
#...#....#
....#.###.
..#...#..#
..##.##.#.

Tile 2687:
###.#..#.#
...#####.#
##.#.....#
##.#......
...##..##.
#...#....#
#.........
#.........
#........#
..##.#....

Tile 1973:
##..#.###.
###..#.##.
####.....#
#...#.....
#....#...#
##.#....#.
#.#.##.#.#
###..#.#.#
##......#.
.#.....#..

Tile 2693:
.##.....#.
....#....#
#.#.#..#..
.##...#..#
##......##
##.#.#.##.
.#....#..#
....##...#
.#......##
...#.#.#..

Tile 2141:
....#####.
.........#
...#.#..##
.......#.#
#...#.#...
..........
...#......
..#.#.#...
#.#.#....#
.......###

Tile 1163:
##.#.##.##
#.....#.#.
.#.###....
..#..#..#.
#......#.#
#.......#.
.#...#.#..
.#...#..##
...#....##
...#.....#

Tile 1091:
##.##...##
#.........
....#.....
#........#
#...#.##.#
##.##.#..#
.........#
.........#
......#.##
####...###

Tile 2281:
...##...#.
....#...##
#..#.#...#
..#.#.....
###......#
.#......##
#........#
.......###
.....#....
##.#.#.##.

Tile 2767:
.##...#..#
..........
..#....##.
#..##....#
..#....#..
...##.#..#
..#####..#
#...###.##
#....#...#
###.##.##.

Tile 1697:
..###.#.#.
#####..#.#
...#...#.#
#.##...###
#.#..##...
......#..#
.##...####
..###.#...
#.##...#.#
#.#...#.#.

Tile 1409:
.######...
.##.....##
#....#..#.
....#...##
#...#.#.##
#..#....##
#......#.#
#...#..#.#
#.##......
.###.#..#.

Tile 3001:
###....#..
##.#..#..#
####..#...
#......#..
.#.#...##.
..#.#.##.#
..#...#.#.
####..##..
.........#
#..#.##...

Tile 1321:
..####.#.#
.##.......
...##.....
#......##.
##..#.....
.........#
##.##...##
#.##......
...#.#...#
##.###.#..

Tile 2707:
###.#..##.
.#....##.#
#...#..##.
#....#....
#.........
#...#.....
.##..#....
#.#..#..##
##....####
..#.##.##.

Tile 2689:
#.#.##.##.
.#......##
#...#...#.
..#...#...
..#......#
..#.#.##..
..........
....#.....
#........#
.#.#.####.

Tile 2551:
.........#
.#.......#
#..###...#
.#.#......
.........#
.#........
#..#....##
.#####....
#........#
.###..##..

Tile 1831:
##.#.#####
...#...###
#..#....#.
.#..#...#.
###......#
##..#..##.
#..#.....#
..#......#
..##.....#
#.....#.#.

Tile 2423:
##.#.#....
..........
#.........
##......#.
#.##.....#
##..#....#
....###..#
####.#..#.
####..#...
.#.#..###.

Tile 1373:
.#..##.#..
...#..#...
#......#..
#.##..#.##
..#..#....
##......##
#....#....
##..###...
#....#.#.#
#...#.###.

Tile 1123:
##.#..#..#
#.....#.##
#..##.##.#
#....#...#
..#.#.....
##.##.....
#...#..#.#
#..#.#....
..........
.###......

Tile 2647:
..#.##.##.
#......#.#
........#.
#....####.
..........
##....#.##
...#......
....#.....
.##.....#.
.#...##.##

Tile 2557:
...#..###.
.....##...
....##..#.
..#..#.#..
##....#..#
#.......#.
##......##
#.#..###..
.#.#.##...
.###.##..#

Tile 2003:
#..#...#..
#.#......#
..#.#.....
#.......##
.....#....
.....#...#
....##.#..
......#..#
...##.#..#
##....#.##

Tile 1051:
#..#....##
#..#...###
.......###
...##..#.#
#...#.....
#......##.
#.......#.
..##....##
.......#.#
.#.##..###

Tile 3613:
..#.#..##.
....#...#.
##.....#..
...#....##
.##..#...#
..#.#..#..
##..#.....
##..##...#
......##.#
##.#.##.#.

Tile 3529:
.#..#.#.##
.#.##..#..
##..##...#
#...#....#
...#....##
#........#
.#...#...#
...##.#...
#....##..#
##.#.#.#.#

Tile 1291:
#.#.##...#
..#.....#.
#.....#...
##.###.##.
.#.#.#....
.#...##.#.
..#...#.#.
.....#..#.
#...#..#..
#..#.#..#.

Tile 3023:
..#.#..#..
#...###...
.#.......#
.#..#.....
##........
.......#.#
#.......##
.....#...#
#.##......
.#.######.

Tile 1307:
##.###.##.
#.#..#....
.#....#...
#.#.....#.
...#.....#
....#.#...
#........#
##....#...
...#......
.#.##.....

Tile 1301:
###.####.#
.....#....
..#..#.#..
..##..#..#
#.#.#....#
.#...#..##
#....#..#.
.#.###....
.##.#..#.#
...####..#

Tile 3769:
#.#.....#.
.........#
...##...#.
......##..
#........#
#...#.....
.#..#..###
....#...#.
#......#.#
###....#.#

Tile 3727:
..##.##.#.
.........#
...#.#...#
#..#.####.
#..#..#..#
#..#..##..
....##...#
#..#.#...#
...#......
.#.#.##.##

Tile 2851:
..#...##.#
.#.##.#...
##.....#.#
..##.#...#
##....#..#
#..#..##.#
#.##.#.###
.....##...
...#.#....
..##..####

Tile 1787:
.#..#....#
#..#.#...#
#........#
.......#..
...#.....#
#.....#..#
#..#....##
#.....#.##
##.......#
....###..#

Tile 2957:
#.##..#..#
#..#.##.#.
.......#..
..##.##...
...#.....#
.##....#..
...#...#..
.#.##..##.
#..#......
...#.##.#.

Tile 1453:
.#..#.....
#..#......
.#......#.
##..#.#..#
......#...
#####...##
##...#..#.
#.....#.##
.....###..
####.#....

Tile 1549:
.###......
......#..#
#..#.#.#.#
##...#....
#.#.##..#.
#...#...##
........#.
##....#..#
.#...###..
##.##..###`;

const inputArray = input.split('\n\n');
const tiles = {};
inputArray.forEach(info => {
  let tile = info.split('\n');
  let id = tile[0].match(/\d+/)[0];
  tile.splice(0, 1);
  if (tile.length !== 10 || tile[0].length !== 10) throw new Error('different size input');
  tiles[id] = tile;
});

const matches = {};

for (let keys in tiles) {
  let match = {};
  let topRow = tiles[keys][0];
  let bottomRow = tiles[keys][tiles[keys].length-1];
  let leftCol = '';
  let rightCol = '';
  for (let rows of tiles[keys]) {
    leftCol += rows[0];
    rightCol += rows[rows.length-1];
  }
  for (let otherKeys in tiles) {
    if (keys === otherKeys) continue;
    let otherTop = tiles[otherKeys][0];
    let otherBottom = tiles[otherKeys][tiles[otherKeys].length-1];
    let otherLeft = '';
    let otherRight = '';
    for (let rows of tiles[otherKeys]) {
      otherLeft += rows[0];
      otherRight += rows[rows.length-1];
    }
    let otherBorders = [
      otherTop, otherTop.split('').reverse().join(''),
      otherBottom, otherBottom.split('').reverse().join(''),
      otherLeft, otherLeft.split('').reverse().join(''),
      otherRight, otherRight.split('').reverse().join('')
    ];
    if (otherBorders.includes(topRow) || otherBorders.includes(topRow.split('').reverse().join(''))) match.top ? match.top.push(otherKeys) : match.top = [otherKeys];
    if (otherBorders.includes(bottomRow) || otherBorders.includes(bottomRow.split('').reverse().join(''))) match.bottom ? match.bottom.push(otherKeys) : match.bottom = [otherKeys];
    if (otherBorders.includes(leftCol) || otherBorders.includes(leftCol.split('').reverse().join(''))) match.left ? match.left.push(otherKeys) : match.left = [otherKeys];
    if (otherBorders.includes(rightCol) || otherBorders.includes(rightCol.split('').reverse().join(''))) match.right ? match.right.push(otherKeys) : match.right = [otherKeys];
  }
  matches[keys] = match;
}
// console.log(matches);
const borders = {};
const image = new Array(12).fill().map(() => new Array(12));

let product = 1;
for (const keys in matches) {
  let holder = new Set();
  let match = matches[keys];
  for (const key in match) {
    match[key].forEach(item => holder.add(item));
  }
  borders[keys] = holder;
  if (holder.size <= 2) {
    product *= +keys;
    if (image[0][0] === undefined) image[0][0] = keys;
  }
}

console.log('part one', product); // is 18482479935793

//build the image
const borderMatch = (key2, val) => borders[key2].has(val);
const used = new Set();
used.add(image[0][0]);

// console.log(borders[image[0][0]]);
let position = 0;
for (const item of borders[image[0][0]]) {
  if (position === 0) {
    image[0][1] = item;
    position++;
  } else {
    image[1][0] = item;
  }
  used.add(item);
}

//build the top row
const buildTopRow = () => {
  for (let i = 2; i < image.length; i++) {
    for (const item of borders[image[0][i-1]]) {
      if (used.has(item)) continue;
      if (borders[item].size === 3) {
        image[0][i] = item;
        used.add(item);
      } else if (borders[item].size === 2) {
        image[0][i] = item;
        used.add(item);
      }
    }
  }
}

//build the left column
const buildLeftColumn = () => {
  for (let i = 2; i < image.length; i++) {
    for (const item of borders[image[i-1][0]]) {
      if (used.has(item)) continue;
      if (borders[item].size === 3) {
        image[i][0] = item;
        used.add(item);
      } else if (borders[item].size === 2) {
        image[i][0] = item;
        used.add(item);
      }
    }
  }
}
buildTopRow();
buildLeftColumn();

const buildImage = () => {
  for (let i = 1; i < image.length; i++) {
    for (let j = 1; j < image[0].length; j++) {
      const left = image[i-1][j];
      const top = image[i][j-1];
      for (const item of borders[left]) {
        if (used.has(item)) continue;
        if (borderMatch(top, item)) {
          image[i][j] = item;
          used.add(item);
          break;
        }
      }
    }
  }
}
buildImage();

console.table(image);